**name：Mingyuan Cao   
student ID: 700761039**

# Q3 — Byte Pair Encoding (BPE)

## 3.1 手工 BPE（玩具语料）

**语料：**  
```
low low low low low lowest lowest newer newer newer newer newer newer wider wider wider new new
```

**初始词表 (|V| = 11)：**  
`_, d, e, i, l, n, o, r, s, t, w`  

**初始语料（前两行）：**  
```
l o w _
l o w _
```

**前三次合并步骤：**
1. **步骤 1**：最高频二元组 = (`e`, `r`)，出现 9 次  
   - 新 token: `er`，更新后 |V| = 11  
   - 语料片段：  
     ```
     l o w _
     l o w _
     ```
2. **步骤 2**：最高频二元组 = (`er`, `_`)，出现 9 次  
   - 新 token: `er_`，更新后 |V| = 11  
   - 语料片段：  
     ```
     l o w _
     l o w _
     ```
3. **步骤 3**：最高频二元组 = (`n`, `e`)，出现 8 次  
   - 新 token: `ne`，更新后 |V| = 11  
   - 语料片段：  
     ```
     l o w _
     l o w _
     ```

---

## 3.2 迷你 BPE 学习器

**每步最高频 pair 与词表大小：**
```
Step  1: ('e', 'r')    出现=9   |V|=11
Step  2: ('er', '_')   出现=9   |V|=11
Step  3: ('n', 'e')    出现=8   |V|=11
Step  4: ('ne', 'w')   出现=8   |V|=11
Step  5: ('l', 'o')    出现=7   |V|=10
Step  6: ('lo', 'w')   出现=7   |V|=10
Step  7: ('new', 'er_') 出现=6  |V|=11
Step  8: ('low', '_')  出现=5   |V|=12
Step  9: ('w', 'i')    出现=3   |V|=11
Step 10: ('wi', 'd')   出现=3   |V|=10
```

**分词结果：**
- `new` → `['new', '_']`  
- `newer` → `['newer_']`  
- `lowest` → `['low', 'e', 's', 't', '_']`  
- `widest` → `['wid', 'e', 's', 't', '_']`  
- `newestest` → `['new', 'e', 's', 't', 'e', 's', 't', '_']`  

**关键观察：**
- 子词可以组合成 OOV（未登录词），解决生词问题。  
- 高频组合逐渐整体化，低频词被分解成可复用的片段。  
- 一些子词与真实词缀对齐，例如 `er_`。  
- 合并步数越多 → 词表更大、分词更完整；合并过少 → 词表太碎片化。  
- 小规模或领域特定语料学习到的子词可能无法泛化。  

---

## 3.3 段落 BPE（合并步数 = 30）

**前 5 个合并对：**
1. (`s`, `_`) — 出现 11 次, |V|=36  
2. (`n`, `_`) — 出现 10 次, |V|=37  
3. (`e`, `r`) — 出现 8 次, |V|=38  
4. (`d`, `_`) — 出现 7 次, |V|=39  
5. (`.`, `_`) — 出现 6 次, |V|=39  

**最长的 5 个子词：**
- `ubwor` × 2  
- `and_` × 3  
- `s._` × 4  
- `ing` × 4  
- `es_` × 4  

**分词示例：**
- `Subword` → `['S', 'ubwor', 'd_']`  
- `tokenization` → `['to', 'k', 'en', 'iz', 'a', 'ti', 'o', 'n_']`  
- `is` → `['i', 's_']`  
- `widely` → `['w', 'i', 'del', 'y', '_']`  
- `used` → `['u', 's', 'e', 'd_']`  

**反思：**
- 学到的子词包括前缀（如 `re-`）、后缀（如 `-ing`、`-ed`、`-er_`）、词干和完整词。  
- **优点**：处理 OOV、生词分解；词表大小更可控。  
- **缺点**：有时会把有意义的词缀拆开；学习结果依赖语料域。  
- 合并步数影响平衡：太少碎片化严重，太多则接近整词。  
- 本段落中，很多子词与英语常见形态学规则对应（如 `-ing`, `-ed`）。  
